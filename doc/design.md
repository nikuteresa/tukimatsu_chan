# 月末自動通知ツール 設計ドキュメント

## クラス構造

本アプリケーションは以下のクラスで構成されています：

- **Application**: アプリケーション全体を制御するクラス
- **BusinessDayCalculator**: 営業日の計算を行うクラス
- **ConfigManager**: 設定ファイルの読み込みと管理を行うクラス
- **Logger**: ログの記録を行うクラス
- **Notifier**: 通知メッセージの生成を行うクラス

### クラスの責務

- **Application**
  - アプリケーション全体のフロー制御
  - 他のクラスのインスタンス管理

- **BusinessDayCalculator**
  - 営業日（土日・祝日を除く日）の判定
  - 月末最終営業日の判定

- **ConfigManager**
  - 設定ファイルの読み込み
  - デフォルト設定の管理
  - 設定値へのアクセス方法の提供

- **Logger**
  - 通知履歴のログ記録
  - ログファイルの管理

- **Notifier**
  - 通知メッセージの生成
  - 環境変数用の出力生成

## フロー図

```
┌────────────────────┐
│  GitHub Actions    │
│  (定期実行または手動実行) │
└──────────┬─────────┘
           │
┌──────────▼─────────┐
│    Application     │
│ (アプリケーション全体制御) │
└──────────┬─────────┘
           │
           ├─────────────┬─────────────┬─────────────┐
           │             │             │             │
┌──────────▼──────┐ ┌────▼───────┐ ┌───▼────────┐ ┌──▼─────────┐
│ ConfigManager   │ │ BusinessDay│ │ Notifier   │ │ Logger     │
│ (設定ファイル管理)  │ │ Calculator │ │ (通知生成)  │ │ (ログ記録)  │
└─────────────────┘ │ (営業日判定) │ └────────────┘ └────────────┘
                    └────────────┘
```

## 実行フロー

1. GitHub Actionsが定期的（または手動）にmain.rbを実行
2. Application#runメソッドが呼び出される
3. ConfigManagerが設定ファイルを読み込む
4. BusinessDayCalculatorが当日が月末最終営業日かを判定
5. 最終営業日の場合:
   - Notifierが通知メッセージを生成
   - 環境変数としてメッセージ内容を出力
   - Loggerが通知履歴を記録
6. GitHub Actionsがメール送信アクションを実行（環境変数の値を使用）
