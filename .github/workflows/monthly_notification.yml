name: Monthly End Notification

on:
  schedule:
    # 毎日18時に実行（JST = UTC+9）
    - cron: '0 9 * * *'  # UTC 9:00 = JST 18:00
  # 手動実行用
  workflow_dispatch:

jobs:
  check-month-end:
    name: Determine if today is the last business day
    runs-on: ubuntu-latest
    outputs:
      is_last_business_day: ${{ steps.month_end_action.outputs.is_last_business_day }}
      year_month: ${{ steps.month_end_action.outputs.year_month }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Run month-end determination
        id: month_end_action
        uses: ./

      - name: Show result
        run: |
          echo "Is last business day: ${{ steps.month_end_action.outputs.is_last_business_day }}"
          echo "executed_at: ${{ steps.month_end_action.outputs.executed_at_getsumatsu }}"
